<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户登录</title>
    <link rel="stylesheet" href="../bootstrap-4.5.0-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/Register.css">
    <link rel="stylesheet" href="../css/kok-ui.css">
    <link rel="stylesheet" href="../css/load.min.css">
    <script src="../bootstrap-4.5.0-dist/js/jquery.js"></script>
</head>

<body>
    <!-- 左下右上的边角特效 -->
    <div class="rightTopBound"><svg id="rightTopBoundIcon" class="bi bi-grid" width="1em" height="1em"
            style="margin-top: 34px;margin-left: 50px;" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
                d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" />
        </svg></div>
    <div class="leftBottomBound"><svg id="leftBottomBoundIcon" class="bi bi-grid" width="1em" height="1em"
            style="margin-top: 34px;margin-left: 50px;" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
                d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" />
        </svg></div>
    <!-- 菜单 -->
    <div class="kok-menu animate__animated animate__flipInX ">
        <div class="kok-menu-left">
            <a id="login" href="javascript:;"><span class="kok-menu-button1" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                    ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg><span id="kok-mean-username">个人信息</span></span></a>
            <a href="./Upload.html"> <span class="kok-menu-button1" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                    ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg>发布作品</span></a>
            <a id="logout" href="javascript:;"><span class="kok-menu-button1" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                    ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg>注销</span></a>
        </div>
        <div class="kok-menu-right">
            <a href="../index.html"><span class="kok-menu-button2" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg>首页</span></a>
            <a href="./Register.html"><span class="kok-menu-button2" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                    ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg>注册</span></a>
            <a href="./Official_Info.html"> <span class="kok-menu-button2" type="button">&nbsp;<svg
                        class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                        ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                    </svg>官方信息</span></a>
        </div>
        <div class="kok-menu-close"><svg t="1592919053422" class="icon" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="5138" width="48" height="48">
                <path
                    d="M591.142293 511.648675l416.816417-416.816417a54.608106 54.608106 0 0 0 0-76.756848l-2.291249-2.291249a54.54446 54.54446 0 0 0-76.756849 0L512.094196 433.17339 95.277779 15.784161a54.54446 54.54446 0 0 0-76.756848 0L16.229682 18.07541a53.589773 53.589773 0 0 0 0 76.756848l416.816416 416.816417-416.75277 416.880063a54.54446 54.54446 0 0 0 0 76.756848l2.291249 2.291249a54.54446 54.54446 0 0 0 76.756848 0l416.816417-416.816417 416.816416 416.816417a54.54446 54.54446 0 0 0 76.756848 0l2.29125-2.291249a54.54446 54.54446 0 0 0 0-76.756848z"
                    fill="#2c2c2c" p-id="5139"></path>
            </svg></div>
        <div class="kok-menu-center">

        </div>
    </div>

    <!-- 主体内容部分 -->
    <div class="container">
        <div class="topTitle animate__animated animate__rotateInDownLeft" role="alert">
            <h5><svg class="bi bi-arrow-right-square-fill" width="1em" height="1em" style="margin-top:-4px;margin-right: 8px
                ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                        d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm5.646 10.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L9.793 7.5H5a.5.5 0 0 0 0 1h4.793l-2.147 2.146z" />
                </svg>用户登录</h5>
        </div>
        <iframe name="IFR" src="" frameborder="0" style="display: none;"></iframe>
        <form target="IFR" onsubmit="return check();">
            <h2 style="color: rgb(255, 255, 255);text-shadow: 2px 1px rgb(15, 178, 228);">用户登录表</h2>
            <br>
            <p><label>Email：</label>&nbsp;<input id="email" type="text" name="email"></p>
            <p><label>密 码：</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="passwd" type="password" name="password1"></p>
            <p><button type="submit">登录</button>&nbsp;&nbsp;&nbsp;<span
                    style="cursor:crosshair">如果你还没有登录，可以点击它进行></span>>
                <a href="./Register.html">注册</a></p>
            <div id="displayBan">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </form>
        <nav aria-label="breadcrumb" class="partTitle" id="warningTip">
            <ol class="breadcrumb">
                <li class="breadcrumb-item active" aria-current="page"><svg class="bi bi-card-list" width="1em"
                        height="1em" style="margin-top:5px;margin-right: 6px
                ;" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M14.5 3h-13a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
                        <path fill-rule="evenodd"
                            d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8zm0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5z" />
                        <circle cx="3.5" cy="5.5" r=".5" />
                        <circle cx="3.5" cy="8" r=".5" />
                        <circle cx="3.5" cy="10.5" r=".5" />
                    </svg> <span id="HT"></span></li>
            </ol>
        </nav>
    </div>
    <script>
        //采用严格模式进行判断
        "user strict"
        //通过name对input框的对象
        var email = document.getElementsByName("email");
        var password1 = document.getElementsByName("password1");
        var displayBan = document.getElementById("displayBan");
        var displayBanSpan = displayBan.querySelectorAll("span");
        var HT = document.getElementById("HT");

        function setCookie(cname, cvalue, exdays) {
            sessionStorage.username = cvalue;
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toGMTString();
            document.cookie = cname + "=" + cvalue + "; " + expires + "; path=/";
        }

        function check() {
            displayBan.style.top = "0px";
            //保证表单提交值的顺序和安全检测的顺序，采用if...else进行判断嵌套，层层判断后再到密码判断
            //针对前三个文本框进行判断
            if (email[0].value != "" && email[0].value != null && email[0].value.length <= 255 && email[0].value
                .length > 5) {
                displayBanSpan[0].innerHTML = "用户名格式 正确 <font style=\"color:lightgreen;\">✔</font>";
            } else {
                displayBanSpan[0].innerHTML =
                    "输入的用户名不符合要求，请输入用户名不为空且长度不小于5不大于255位 <font style=\"color:red;\"> !</font>";
            }
            if (password1[0].value != "" && password1[0].value != null && password1[0].value.length >= 6) {
                displayBanSpan[1].innerHTML = "密码格式 正确 <font style=\"color:lightgreen;\">✔</font>";
                let tokenCode = parseInt(Math.random() * 10) * 1998;
                displayBanSpan[2].innerHTML = "☆ 表单已经完成填报 ☆";
                if (prompt("确定提交数据请输入验证码" + tokenCode + "：") == tokenCode) {
                    $('#warningTip').fadeOut();
                    $.post("../php/Login.php", {
                            email: $("#email").val().trim(),
                            passwd: $("#passwd").val().trim(),
                        },
                        function (data, status) {
                            if (data.length > 0) {
                                setCookie("email", $("#email").val().trim(), 4);
                                sessionStorage.username = data[0].username;
                                sessionStorage.email = data[0].email;
                                HT.innerHTML =
                                    "欢迎您，验证通过！ <font style=\"color:lightgreen;\">✔</font>";
                                $('#warningTip').fadeIn();
                                displayBanSpan[0].innerHTML =
                                    `<div class="loader">
                                        <div class="loader-inner square-spin">
                                            <div></div>
                                        </div><span class="tooltip">
                                            <p>square-spin</p>
                                        </span>
                                    </div>`;
                                let watingSecond = 2;
                                setInterval(() => {
                                    watingSecond--;
                                    if (watingSecond <= 0) {
                                        window.location.href = '../index.html';
                                    }
                                    // "登录成功！倒数<font style=\"color:lightgreen;\">" + watingSecond +
                                    // "</font>秒后跳转到主页";
                                }, 1000);
                            } else {
                                displayBanSpan[3].innerHTML =
                                    "登录失败！请检查<font style=\"color:red;\"> 密码 </font>或<font style=\"color:red;\"> 用户名 </font><font style=\"color:red;\">! </font>";
                            }
                        });

                } else {
                    setTimeout(window.location.href = '../index.html', 3000);
                }
            } else {
                displayBanSpan[1].innerHTML =
                    "输入密码不符合要求，请输入密码不为空且长度不小于6不大于12位 <font style=\"color:red;\"> !</font>";
            }
        }
    </script>
    <script src="../js/Level2_Layer.js"></script>
</body>

</html>